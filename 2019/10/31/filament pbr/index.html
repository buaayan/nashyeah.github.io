<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: 'å¤åˆ¶',
      copy_success: 'å¤åˆ¶æˆåŠŸ',
      copy_failure: 'å¤åˆ¶å¤±è´¥'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="æè´¨ç³»ç»Ÿ Standard model æ•°å­¦æè¿°ï¼šBSDF (Bidirectional Scattering Distribution Function) = BRDF (Bidirectional Reflectance Distribution Function) + BTDF (Bidirectional Transmittance Function) ç€é‡åœ¨BRDFï¼Œå¿½è§†BTDFï¼Œæ­£ç¡®çš„">
<meta property="og:type" content="article">
<meta property="og:title" content="filament pbr">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;10&#x2F;31&#x2F;filament%20pbr&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="æè´¨ç³»ç»Ÿ Standard model æ•°å­¦æè¿°ï¼šBSDF (Bidirectional Scattering Distribution Function) = BRDF (Bidirectional Reflectance Distribution Function) + BTDF (Bidirectional Transmittance Function) ç€é‡åœ¨BRDFï¼Œå¿½è§†BTDFï¼Œæ­£ç¡®çš„">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_fr_fd.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_microfacet.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_macrosurface.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_shadowing_masking.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_roughness.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_micro_vs_macro.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_scattering.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_brdf_dielectric_conductor.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_lambert_vs_disney.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_single_vs_multi_scatter.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;material_metallic_energy_loss.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;material_metallic_energy_preservation.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;material_furnace_energy_loss.png">
<meta property="og:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;material_furnace_energy_preservation.png">
<meta property="og:updated_time" content="2019-11-25T15:27:25.975Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;google.github.io&#x2F;filament&#x2F;images&#x2F;diagram_fr_fd.png">

<link rel="canonical" href="http://yoursite.com/2019/10/31/filament%20pbr/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true,
    isPage: false,
    isArchive: false
  };
</script>

  <title>filament pbr | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>å½’æ¡£</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/31/filament%20pbr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/uploads/avatar.jpg">
      <meta itemprop="name" content="å¼ å²©">
      <meta itemprop="description" content="å¼ å²©çš„ä¸ªäººblog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          filament pbr
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2019-10-31 22:08:51" itemprop="dateCreated datePublished" datetime="2019-10-31T22:08:51+08:00">2019-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2019-11-25 23:27:25" itemprop="dateModified" datetime="2019-11-25T23:27:25+08:00">2019-11-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>æè´¨ç³»ç»Ÿ</p>
<p>Standard model</p>
<p>æ•°å­¦æè¿°ï¼šBSDF (Bidirectional Scattering Distribution Function) = BRDF (Bidirectional Reflectance Distribution Function) + BTDF (Bidirectional Transmittance Function)</p>
<p>ç€é‡åœ¨BRDFï¼Œå¿½è§†BTDFï¼Œæ­£ç¡®çš„æ¸²æŸ“åå°„ã€å„å‘åŒæ€§ã€å¯¼ç”µä½“è¡¨é¢ã€‚BRDFåŒ…å«ä¸¤é¡¹ï¼šdiffuseé¡¹å’Œspecularé¡¹ã€‚ä¸è€ƒè™‘æ¬¡è¡¨é¢æ•£å°„çš„ç¤ºæ„å›¾ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_fr_fd.png" alt="img"></p>
<p>å®Œæ•´çš„è¡¨é¢åå°„è¡¨ç¤ºå…¬å¼ï¼š</p>
<p>ğ‘“(ğ‘£,ğ‘™)=ğ‘“ğ‘‘(ğ‘£,ğ‘™)+ğ‘“ğ‘Ÿ(ğ‘£,ğ‘™)</p>
<p>å®Œæ•´çš„æ¸²æŸ“æ–¹ç¨‹éœ€è¦ç§¯åˆ†æ•´ä¸ªåŠçƒé¢çš„æ–¹å‘å…¥å°„å…‰ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå…¥å°„è¡¨é¢å¹¶ä¸æ˜¯å®Œå…¨æ°´å¹³çš„ï¼Œéœ€è¦å»ºæ¨¡å…‰å’Œä¸è§„åˆ™å¹³é¢çš„äº¤äº’ã€‚microfacet BRDFæ˜¯ä¸€ä¸ªç‰©ç†ä¸Šè‡ªæ´½çš„å»ºæ¨¡æ–¹å¼ï¼Œè¿™æ ·åœ¨å¾®å°çº§åˆ«ä¸å¹³æ»‘ï¼Œå¹¶ä¸”ç”±å¤§é‡éšæœºå¹³é¢ç¢ç‰‡ç»„æˆçš„è¡¨é¢è¢«ç§°ä¸ºmicrofacetã€‚</p>
<p>å…‰ç…§åœ¨microfacetä¸Šå’Œå…‰æ»‘å¹³é¢ä¸Šäº¤äº’çš„åŒºåˆ«ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_microfacet.png" alt="img"></p>
<p>åªæœ‰æ³•çº¿åœ¨å…¥å°„å…‰å’Œè§‚å¯Ÿæ–¹å‘ä¹‹é—´çš„å¾®è¡¨é¢ï¼ˆmicrofacetï¼‰èƒ½å¤Ÿåå°„å…‰çº¿ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_macrosurface.png" alt="img"></p>
<p>ä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„æ»¡è¶³æ³•çº¿è¦æ±‚çš„å¾®è¡¨é¢éƒ½èƒ½è¢«çœ‹åˆ°ï¼Œå› ä¸ºBRDFè€ƒè™‘åˆ°äº†é®æŒ¡å’Œé˜´å½±ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_shadowing_masking.png" alt="img"></p>
<p>å¾®è¡¨é¢BRDFä¸­<em>roughness</em>å‚æ•°èµ·é‡è¦ä½œç”¨ï¼Œä¸‹å›¾ä¸­è“è‰²åŒºåŸŸä¸ºspecularå…‰èŒƒå›´ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_roughness.png" alt="img"></p>
<p>microfacet modelå¦‚ä¸‹ï¼ˆxä»£è¡¨diffuse/specularï¼‰ï¼š</p>
<p>ğ‘“ğ‘¥(ğ‘£,ğ‘™)=1/|ğ‘›â‹…ğ‘£||ğ‘›â‹…ğ‘™|âˆ«Î©ğ·(ğ‘š,ğ›¼)ğº(ğ‘£,ğ‘™,ğ‘š)ğ‘“ğ‘š(ğ‘£,ğ‘™,ğ‘š)(ğ‘£â‹…ğ‘š)(ğ‘™â‹…ğ‘š)ğ‘‘ğ‘š</p>
<p>å…¶ä¸­ï¼ŒDä»£è¡¨å¾®è¡¨é¢åˆ†å¸ƒï¼ˆNormal Distribution Functionï¼‰ï¼ŒGä»£è¡¨å¾®è¡¨é¢å¯è§æ€§ï¼ˆé®æŒ¡/é˜´å½±éƒ¨åˆ†ï¼‰ï¼Œå¾®è¡¨é¢çš„åŠçƒé¢ç§¯åˆ†ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_micro_vs_macro.png" alt="img"></p>
<p>å·¦è¾¹æ˜¯å¾®è¡¨é¢çº§åˆ«æ˜¯å¹³æ»‘çš„æ¨¡å‹ï¼Œå³è¾¹æ˜¯ä¸å¹³æ»‘ï¼Œèƒ½å¤ŸæŠŠå¹³è¡Œå…‰åå°„ä¸ºéå¹³è¡Œå…‰ã€‚å¯¹äºdiffuseå’Œspecularé¡¹ï¼Œé€šè¿‡è¿‘ä¼¼çš„æ–¹å¼è®¡ç®—åŠçƒé¢ç§¯åˆ†ã€‚</p>
<p>Dielectrics and conductors</p>
<p>ç†è§£é‡‘å±metallic (conductor) å’Œéé‡‘å± non-metallic (dielectric) è¡¨é¢ï¼š</p>
<p>å¦‚Standard model BRDFä¸­ï¼Œå…‰åœ¨è¡¨é¢è¢«åˆ†ç¦»ä¸ºä¸¤éƒ¨åˆ†ï¼Œå®é™…ä¸Šè¿˜æœ‰ä¸€éƒ¨åˆ†å…¥å°„å…‰ä¼šç©¿é€è¡¨é¢ï¼Œåœ¨å†…éƒ¨æ•£å°„ï¼Œæœ€ç»ˆå˜æˆdiffuseåå°„å‡ºå»ï¼š</p>
<p><img src="https://google.github.io/filament/images/diagram_scattering.png" alt="img"></p>
<p>é‡‘å±å’Œéé‡‘å±çš„ä¸åŒç‚¹ï¼šé‡‘å±æè´¨ä¸Šä¸å­˜åœ¨æ¬¡è¡¨é¢æ•£å°„ç°è±¡ï¼Œå³æ²¡æœ‰diffuseæˆåˆ†ï¼›éé‡‘å±æè´¨ä¸Šå­˜åœ¨æ¬¡è¡¨é¢æ•£å°„ï¼ŒåŒ…å«diffuseå’Œspecularæˆåˆ†ã€‚</p>
<p><img src="https://google.github.io/filament/images/diagram_brdf_dielectric_conductor.png" alt="img"></p>
<p>Energy conservation</p>
<p>èƒ½é‡è½¬æ¢çš„BRDFï¼šåå°„çš„diffuseå’Œspecularèƒ½é‡å°äºæ€»å…¥å°„èƒ½é‡ï¼Œä¸ç”¨å†å…³æ³¨å‡ºå°„å…‰èƒ½é‡è¶…å‡ºäº†ã€‚</p>
<p>Specular BRDF</p>
<p>å¯¹äºspecularé¡¹ï¼Œğ‘“ğ‘šæ˜¯ç”±Fresnel lawå»ºæ¨¡çš„é•œåƒBRDFï¼Œå…¶ä¸­Cook-Torranceè¿‘ä¼¼ä¸­ğ¹å»ºæ¨¡å¾®è¡¨é¢ç§¯åˆ†ï¼š</p>
<p>ğ‘“ğ‘Ÿ(ğ‘£,ğ‘™)=ğ·(â„,ğ›¼)ğº(ğ‘£,ğ‘™,ğ›¼)ğ¹(ğ‘£,â„,ğ‘“0) /(4(ğ‘›â‹…ğ‘£)(ğ‘›â‹…ğ‘™))</p>
<p>ç”±äºå®æ—¶çš„é™å®šï¼ŒD,G,Féœ€è¦ä½¿ç”¨è¿‘ä¼¼å€¼ï¼Œæœ¬æ–‡ä¸­é€‰å–å¦‚ä¸‹ï¼š</p>
<p>Normal distribution function (specular D)</p>
<p>$ D_{GGX}(h,\alpha) = \frac{a^2}{\pi ( (nh)^2 (a^2 - 1) + 1)^2} $</p>
<p>GLSLä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">float D_GGX(float NoH, float roughness) &#123;</span><br><span class="line">    float a = NoH * roughness;</span><br><span class="line">    float k = roughness / (1.0 - NoH * NoH + a * a);</span><br><span class="line">    return k * k * (1.0 / PI);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥é€šè¿‡ä½¿ç”¨åŠç²¾åº¦æµ®ç‚¹æ•°æå‡åº”ç”¨æ•ˆç‡ï¼Œè¿™ä¸ªä¼˜åŒ–éœ€è¦æŠŠåŠç²¾åº¦æµ®ç‚¹æ•°è®¡ç®—$1 - (nh)^2$æœ‰ä¸¤ä¸ªé—®é¢˜ï¼š1.å½“$(nh)^2$æ¥è¿‘äº1æ—¶ä¼šäº§ç”Ÿæµ®ç‚¹æ•°æ¶ˆé™¤é—®é¢˜ï¼›2.$nh$åœ¨1é™„è¿‘æ²¡æœ‰è¶³å¤Ÿçš„ç²¾åº¦ã€‚</p>
<p>åˆ©ç”¨Lagrangeâ€™s identityï¼š</p>
<p>$| a \times b |^2 = |a|^2 |b|^2 - (a \cdot b)^2$</p>
<p>å› ä¸ºnå’Œhæ˜¯å•ä½å‘é‡ï¼Œ$|n \times h|^2 = 1 - (nh)^2$å…è®¸é€šè¿‡åŠç²¾åº¦æµ®ç‚¹å‰ä¹˜è®¡ç®—ï¼Œåº”ç”¨ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#define MEDIUMP_FLT_MAX    65504.0</span><br><span class="line">#define saturateMediump(x) min(x, MEDIUMP_FLT_MAX)</span><br><span class="line"></span><br><span class="line">float D_GGX(float roughness, float NoH, const vec3 n, const vec3 h) &#123;</span><br><span class="line">    vec3 NxH = cross(n, h);</span><br><span class="line">    float a = NoH * roughness;</span><br><span class="line">    float k = roughness / (dot(NxH, NxH) + a * a);</span><br><span class="line">    float d = k * k * (1.0 / PI);</span><br><span class="line">    return saturateMediump(d);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Geometric shadowing (specular G)</p>
<p>Smith geometric shadowing function:</p>
<p>$G(v,l,a) = G_1(l,a) G_1(v,a)$</p>
<p>$G_1$æœ‰å¤šç§å½¢å¼ï¼Œæœ€é€šç”¨çš„GGXå½¢å¼å¦‚ä¸‹ï¼š</p>
<p>$G_1(v,\alpha) = G_{GGX}(v,\alpha) = \frac{2 (nv)}{nv + \sqrt{a^2 + (1 - a^2) (nv)^2}}<br>$</p>
<p>å®Œæ•´çš„Smith-GGXå…¬å¼å¦‚ä¸‹ï¼š</p>
<p>$G(v,l,\alpha) = \frac{2 (nl)}{nl + \sqrt{a^2 + (1 - a^2) (nl)^2}} \frac{2 (nv)}{nv + \sqrt{a^2 + (1 - a^2) (nv)^2}}$</p>
<p>ç”±åˆ†æ¯å¯ä»¥ç®€åŒ–æ•´ä¸ªå…¬å¼ï¼š</p>
<p>$f_r(v,l) = D(h, \alpha) V(v, l, \alpha) F(v, h, f_0)<br>$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$V(v,l,\alpha) = \frac{G(v, l, \alpha)}{4 (nv) (nl)} = V_1(l,\alpha) V_1(v,\alpha)$</p>
<p>$V_1(v,\alpha) = \frac{1}{nv + \sqrt{a^2 + (1 - a^2) (nv)^2}}$</p>
<p>æ·»åŠ å¾®è¡¨é¢é«˜åº¦å¯ä»¥è·å¾—æ›´å‡†ç¡®çš„é®æŒ¡å’Œé˜´å½±å‰”é™¤ç»“æœï¼Œheight-correlated Smith functionï¼š</p>
<p>$G(v,l,h,\alpha) = \frac{\chi^+(vh) \chi^+(lh)}{1 + \Lambda(v) + \Lambda(l)}$</p>
<p>$\Lambda(m) = \frac{-1 + \sqrt{1 + a^2 tan^2(\theta_m)}}{2} = \frac{-1 + \sqrt{1 + a^2 \frac{(1 - cos^2(\theta_m))}{cos^2(\theta_m)}}}{2}$</p>
<p>ä½¿ç”¨nvæ›¿æ¢ ğœƒğ‘šï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<p>$\Lambda(v) = \frac{1}{2} \left( \frac{\sqrt{a^2 + (1 - a^2)(nv)^2}}{nv} - 1 \right)$</p>
<p>å¸¦å…¥visiblitity functionï¼š</p>
<p>$V(v,l,\alpha) = \frac{0.5}{nl \sqrt{(nv)^2 (1 - a^2) + a^2} + nv \sqrt{(nl)^2 (1 - a^2) + a^2}}$</p>
<p>GLSLä»£ç å¦‚ä¸‹ï¼Œä½¿ç”¨ä¸¤ä¸ªsqrtæ¯”è¾ƒæ˜‚è´µï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">float V_SmithGGXCorrelated(float NoV, float NoL, float roughness) &#123;</span><br><span class="line">    float a2 = roughness * roughness;</span><br><span class="line">    float GGXV = NoL * sqrt(NoV * NoV * (1.0 - a2) + a2);</span><br><span class="line">    float GGXL = NoV * sqrt(NoL * NoL * (1.0 - a2) + a2);</span><br><span class="line">    return 0.5 / (GGXV + GGXL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„åˆ°æ‰€æœ‰æ ¹å·ä¸‹çš„é¡¹éƒ½æ˜¯å¹³æ–¹é¡¹ï¼Œå¹¶ä¸”èŒƒå›´åœ¨[0â€¦1]ï¼Œæ‰€ä»¥æ‰“å¼€æ ¹å·å’Œå¹³æ–¹ï¼š</p>
<p>$V(v,l,\alpha) = \frac{0.5}{nl (nv (1 - \alpha) + \alpha) + nv (nl (1 - \alpha) + \alpha)}$</p>
<p>è¿™ä¸ªç®€åŒ–åœ¨æ•°å­¦ä¸Šæ˜¯ä¸æˆç«‹çš„ï¼Œä¸è¿‡èƒ½ç®€åŒ–æ‰ä¸¤ä¸ªå¼€æ ¹å·ï¼Œåœ¨ç§»åŠ¨ç«¯èƒ½å¤Ÿä¼˜åŒ–å¾ˆå¤šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">float V_SmithGGXCorrelatedFast(float NoV, float NoL, float roughness) &#123;</span><br><span class="line">    float a = roughness;</span><br><span class="line">    float GGXV = NoL * (NoV * (1.0 - a) + a);</span><br><span class="line">    float GGXL = NoV * (NoL * (1.0 - a) + a);</span><br><span class="line">    return 0.5 / (GGXV + GGXL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸€ç®€åŒ–åœ¨17å¹´è¢«lerpsé‡å†™ï¼š</p>
<p>$V(v,l,\alpha) = \frac{0.5}{lerp(2 (nl) (nv), nl + nv, \alpha)}$</p>
<p>Fresnel (specular F)</p>
<p>Fresnelåœ¨PBRæè´¨ä¸­æ‰®æ¼”é‡è¦è§’è‰²ï¼Œè§‚å¯Ÿè€…æ”¶åˆ°åå°„å…‰é‡å–å†³äºè§‚å¯Ÿè§’åº¦ã€‚æ°´ä½“æ˜¯è¿™ä¸€ç°è±¡çš„ç»ä½³è¯æ˜ï¼šå½“å‚ç›´çœ‹å…¥æ°´ä¸­ä¼šçœ‹é€æ°´ä½“ï¼Œè€Œç«™è¿œä¸€ç‚¹ä»¥è¾ƒå¹³è¡Œçš„è§’åº¦è§‚å¯Ÿæ°´ä½“ï¼Œå¯ä»¥çœ‹åˆ°specularåå°„è¶Šæ¥è¶Šå¼ºçƒˆã€‚</p>
<p>å…‰çš„åå°„é‡ä¸ä»…ä»…å–å†³äºè§‚å¯Ÿè§†è§’ï¼Œè¿˜å–å†³äºæè´¨çš„index of refraction (IOR)ã€‚æ²¿æ³•çº¿æ–¹å‘ï¼ˆå‚ç›´äºè¡¨é¢ï¼‰æ—¶ï¼Œå‘å°„å…‰çš„é‡è¢«è®°ä¸ºğ‘“0å¹¶ä¸”å¯ä»¥ä»IORæ´¾ç”Ÿå‡ºæ¥ã€‚åœ¨å¹³è¡Œæ–¹å‘çš„åå°„é‡è¢«è®°ä¸ºğ‘“90å¹¶ä¸”å¯¹äºå…‰æ»‘æè´¨èƒ½å¤Ÿè¾¾åˆ°100%ã€‚</p>
<p>æ›´é€šä¿—çš„è®²ï¼ŒFresnelé¡¹å®šä¹‰äº†å…‰å¦‚ä½•åœ¨ä¸¤ç§ä»‹è´¨åå°„å’ŒæŠ˜å°„ï¼Œæˆ–è€…è¯´åå°„å’Œå¸æ”¶çš„èƒ½é‡æ¯”ä¾‹ã€‚Cook-Torrance specular BRDFä¸­ï¼Œè¾ƒä¸ºç®€å•çš„è¿‘ä¼¼Fresnelé¡¹ï¼š</p>
<p>$F_{Schlick}(v,h,f0,f90) = f0 + (f90 - f0)(1 - vh)^5$</p>
<p>å¸¸é‡ğ‘“0ä»£è¡¨åœ¨å‘ç°æ–¹å‘çš„specularåå°„ï¼Œéé‡‘å±æ— è‰²ï¼Œé‡‘å±æœ‰è‰²ï¼Ÿï¼Ÿï¼Ÿã€‚å®é™…æ•°å€¼ä¾èµ–è¡¨é¢çš„IORï¼Œå®é™…å®ç°éœ€è¦ç”¨åˆ°æ¬¡æ–¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vec3 F_Schlick(float VoH, vec3 f0, float f90) &#123;</span><br><span class="line">    return f0 + (vec3(f90) - f0) * pow(1.0 - VoH, 5.0);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªFresnelå‡½æ•°å¯ä»¥çœ‹åšå‚ç›´specularåå°„å’Œæ°´å¹³æ–¹å‘åå°„çš„æ’å€¼ï¼Œè§‚å¯Ÿç°å®ä¸–ç•Œä¸­çš„æè´¨ï¼Œå¯¼ä½“å’Œéå¯¼ä½“æè´¨åœ¨æ°´å¹³æ–¹å‘è§‚å¯Ÿæ—¶çš„specularåå°„æ˜¯æ— å·®åˆ«çš„ï¼Œä¹Ÿå°±æ˜¯Fresnelåå°„åœ¨90åº¦æ—¶ä¸º1.0ã€‚æ›´å‡†ç¡®çš„ğ‘“90åœ¨åæ–‡ä¸­ä¼šæ¢è®¨ã€‚</p>
<p>ä»¤ğ‘“90=1ï¼ŒFresnelé¡¹çš„Schlickè¿‘ä¼¼å¯ä»¥ä¼˜åŒ–ä¸ºä¹˜æ³•å…³ç³»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vec3 F_Schlick(float VoH, vec3 f0) &#123;</span><br><span class="line">    float f = pow(1.0 - VoH, 5.0);</span><br><span class="line">    return f + f0 * (1.0 - f);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Diffuse BRDF</p>
<p>diffuseé¡¹ä¸­ï¼Œğ‘“ğ‘šæ˜¯Lambertianå‡½æ•°ï¼Œdiffuseé¡¹å˜ä¸ºï¼š<br>$$<br>fm(v,l) = \frac{\sigma}{\pi} \frac{1}{| n \cdot v | | n \cdot l |}<br>\int_\Omega D(m,\alpha) G(v,l,m) (v \cdot m) (l \cdot m) dm<br>$$<br>ç®€åŒ–ç­‰æ•ˆä¸ºï¼š</p>
<p>$fm(v,l) = \frac{\sigma}{\pi} $</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">float Fd_Lambert() &#123;</span><br><span class="line">    return 1.0 / PI;</span><br><span class="line">&#125;</span><br><span class="line">vec3 Fd = diffuseColor * Fd_Lambert();</span><br></pre></td></tr></table></figure>

<p>Lmbertian BRDFè¶³å¤Ÿé«˜æ•ˆã€æ•ˆæœä¹Ÿè¶³å¤Ÿå¥½ã€‚ç„¶è€Œï¼Œç†æƒ³æƒ…å†µä¸‹diffuseé¡¹å’Œspecularé¡¹ä¸€æ ·è€ƒè™‘è¡¨é¢roughnessã€‚å¤§éƒ¨åˆ†å…¬å¼éƒ½è€ƒè™‘äº†roughnesså¹¶åœ¨æ¥è¿‘æ°´å¹³è§‚å¯Ÿæ—¶äº§ç”Ÿåå‘åå°„çš„æ•ˆæœã€‚æœ¬æ–‡è€ƒè™‘æ·»åŠ åçš„å¤æ‚è®¡ç®—å’Œæ”¶æ•ˆç”šå¾®ã€‚</p>
<p>å®Œæ•´æ€§èµ·è§ï¼Œè¿˜æ˜¯åˆ—å‡ºè¿ªå£«å°¼çš„diffuse BRDFå…¬å¼å’Œä»£ç å®ç°ï¼š</p>
<p>$fd(v,l) = \frac{\sigma}{\pi} Fschlick(n,l,1,f90) Fschlick(n,v,1,f90)$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$f90=0.5 + 2 \cdot \alpha cos^2(\theta_d)$</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">float F_Schlick(float VoH, float f0, float f90) &#123;</span><br><span class="line">    return f0 + (f90 - f0) * pow(1.0 - VoH, 5.0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">float Fd_Burley(float NoV, float NoL, float LoH, float roughness) &#123;</span><br><span class="line">    float f90 = 0.5 + 2.0 * roughness * LoH * LoH;</span><br><span class="line">    float lightScatter = F_Schlick(NoL, 1.0, f90);</span><br><span class="line">    float viewScatter = F_Schlick(NoV, 1.0, f90);</span><br><span class="line">    return lightScatter * viewScatter * (1.0 / PI);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‹å›¾æ˜¯å®Œå…¨ç²—ç³™çš„å¯¼ç”µä½“æè´¨ä¸¤ç§BRDFæ¯”è¾ƒï¼Œè¡¨é¢å…‰ç…§è¡¨ç°ååˆ†ç›¸ä¼¼ï¼Œè¿ªå£«å°¼çš„é«˜è´¨é‡diffuse BRDFåœ¨è¾¹ç¼˜å¤„è¡¨ç°å‡ºæ›´å¥½çš„åå‘åå°„ã€‚</p>
<p><img src="https://google.github.io/filament/images/diagram_lambert_vs_disney.png" alt="img"></p>
<p>Standard model summary</p>
<p>Specularé¡¹ï¼šCook-Torrance specularå¾®è¡¨é¢æ¨¡å‹ã€GGXæ³•çº¿åˆ†å¸ƒå‡½æ•°ã€Smith-GGXé«˜åº¦çŸ«æ­£çš„å¯è§æ€§å‡½æ•°ï¼ŒSchlick Fresnelå‡½æ•°</p>
<p>Diffuseé¡¹ï¼šLambertian diffuseæ¨¡å‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">float D_GGX(float NoH, float a) &#123;</span><br><span class="line">    float a2 = a * a;</span><br><span class="line">    float f = (NoH * a2 - NoH) * NoH + 1.0;</span><br><span class="line">    return a2 / (PI * f * f);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vec3 F_Schlick(float VoH, vec3 f0) &#123;</span><br><span class="line">    return f0 + (vec3(1.0) - f0) * pow(1.0 - VoH, 5.0);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">float V_SmithGGXCorrelated(float NoV, float NoL, float a) &#123;</span><br><span class="line">    float a2 = a * a;</span><br><span class="line">    float GGXL = NoV * sqrt((-NoL * a2 + NoL) * NoL + a2);</span><br><span class="line">    float GGXV = NoL * sqrt((-NoV * a2 + NoV) * NoV + a2);</span><br><span class="line">    return 0.5 / (GGXV + GGXL);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">float Fd_Lambert() &#123;</span><br><span class="line">    return 1.0 / PI;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void BRDF(...) &#123;</span><br><span class="line">    vec3 h = normalize(v + l);</span><br><span class="line"></span><br><span class="line">    float NoV = abs(dot(n, v)) + 1e-5;</span><br><span class="line">    float NoL = clamp(dot(n, l), 0.0, 1.0);</span><br><span class="line">    float NoH = clamp(dot(n, h), 0.0, 1.0);</span><br><span class="line">    float LoH = clamp(dot(l, h), 0.0, 1.0);</span><br><span class="line"></span><br><span class="line">    // perceptually linear roughness to roughness (see parameterization)</span><br><span class="line">    float roughness = perceptualRoughness * perceptualRoughness;</span><br><span class="line"></span><br><span class="line">    float D = D_GGX(NoH, a);</span><br><span class="line">    vec3  F = F_Schlick(LoH, f0);</span><br><span class="line">    float V = V_SmithGGXCorrelated(NoV, NoL, roughness);</span><br><span class="line"></span><br><span class="line">    // specular BRDF</span><br><span class="line">    vec3 Fr = (D * V) * F;</span><br><span class="line"></span><br><span class="line">    // diffuse BRDF</span><br><span class="line">    vec3 Fd = diffuseColor * Fd_Lambert();</span><br><span class="line"></span><br><span class="line">    // apply lighting...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æå‡BRDF</p>
<p>ä¹‹å‰æåˆ°èƒ½é‡å®ˆæ’BRDFæ˜¯å¦çœŸå®çš„å…³é”®æ ‡å‡†ï¼Œä¸Šè¿°æåˆ°çš„BRDFå…¬å¼å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼šdiffuseåå°„ä¸­çš„èƒ½é‡å¢ç›Šï¼ˆTODOï¼‰å’Œspecularåå°„ä¸­çš„èƒ½é‡ä¸¢å¤±ã€‚</p>
<p>Cook-Torrance BRDFé€šè¿‡è€ƒè™‘å…‰åœ¨å¾®è¡¨é¢é—´çš„è·³è·ƒæ¥è¿›è¡Œå»ºæ¨¡ï¼Œè¿™ç§å‡è®¾åœ¨é«˜åº¦roughnessä¸‹ä¼šå¯¼è‡´èƒ½é‡æŸå¤±ï¼ˆè¡¨é¢æœ¬èº«ä¸æ˜¯èƒ½é‡å®ˆæ’çš„ï¼‰ã€‚ä¸‹å›¾ä¸ºèƒ½é‡æŸå¤±çš„ç¤ºæ„å›¾ï¼Œå•çº§è·³è·ƒçš„æƒ…å†µä¸‹åå°„åˆ°å¦ä¸€ä¸ªå¾®è¡¨é¢çš„å…‰çº¿ä¼šè¢«å¸æ”¶ï¼ˆmasking and shadowingï¼‰ï¼Œè€Œåœ¨äºŒçº§è·³è·ƒæƒ…å†µä¸‹ï¼Œå…‰çº¿ä¼šè¢«å†æ¬¡åå°„å›è§‚å¯Ÿè€…ã€‚</p>
<p><img src="https://google.github.io/filament/images/diagram_single_vs_multi_scatter.png" alt="img"></p>
<p>åŸºäºè¿™æ ·çš„å‡è®¾ï¼Œå¯ä»¥ç®€å•æè¿°ä¸ºï¼šè¡¨é¢è¶Šç²—ç³™ï¼Œè¶Šæœ‰å¯èƒ½äº§ç”Ÿèƒ½é‡æŸå¤±ï¼Œå› ä¸ºæ— æ³•è¡¡é‡å¤šåå°„çš„æƒ…å†µã€‚è¿™ç§æƒ…å†µå‡ºç°åœ¨é»‘æš—æƒ…å†µä¸‹çš„ç²—ç³™æè´¨ä¸Šï¼Œå¯¼ä½“æè´¨å°¤å…¶æ˜¾è‘—ï¼Œå› ä¸ºåå°„éƒ½æ˜¯specularã€‚ä¸‹å›¾æ˜¯å˜æš—çš„å½±å“ï¼š</p>
<p><img src="https://google.github.io/filament/images/material_metallic_energy_loss.png" alt="img"></p>
<p>ä¸‹å›¾æ˜¯èƒ½é‡å®ˆæ’ï¼ˆenergy preservationï¼‰åçš„ç»“æœï¼š</p>
<p><img src="https://google.github.io/filament/images/material_metallic_energy_preservation.png" alt="img"></p>
<p>æˆ‘ä»¬ç”¨çº¯ç™½è‰²éªŒè¯ BRDF çš„èƒ½é‡å®ˆæ’ï¼Œå¦‚æœè¾¾åˆ°èƒ½é‡å®ˆæ’ï¼Œä¸€ä¸ªçº¯ç²¹åå°„çš„é‡‘å±è¡¨é¢ï¼ˆğ‘“0=1ï¼‰ä½¿æ— æ³•ä»èƒŒæ™¯ä¸­åŒºåˆ†å‡ºæ¥ï¼Œä¸‹å›¾æ‰€ç¤ºä¼´éšç²—ç³™åº¦å¢åŠ ï¼Œèƒ½é‡æŸå¤±çš„æƒ…å†µè¶Šæ¥è¶Šæ˜æ˜¾ã€‚</p>
<p><img src="https://google.github.io/filament/images/material_furnace_energy_loss.png" alt="img"></p>
<p>ä¸‹å›¾æ˜¯è€ƒè™‘åˆ°å¤šè·³è·ƒæƒ…å†µä¸‹çš„èƒ½é‡æŸå¤±ç¤ºæ„å›¾ï¼š</p>
<p><img src="https://google.github.io/filament/images/material_furnace_energy_preservation.png" alt="img"></p>
<p>åœ¨[Heitz16]ä¸­æ·±å…¥è®¨è®ºäº†å¤šæ•£å°„å¾®è¡¨é¢ BRDFsï¼Œæœ¬æ–‡åªå‘ˆç°ä¸€ç§å¤šæ•£å°„å¾®è¡¨é¢BRDF çš„éšæœºè¯„ä¼°ï¼ˆstochastic evaluationï¼‰ï¼Œè¿™ç§æ–¹æ¡ˆå¹¶ä¸é€‚ç”¨äºå®æ—¶æ¸²æŸ“ã€‚[Kulla17]ä¸­æä¾›äº†å¦å¤–ä¸€ç§æ–¹æ³•ï¼šåœ¨BRDFå…¬å¼ä¸­æ·»åŠ èƒ½é‡è¡¥å¿é¡¹ï¼š</p>
<p>$f_{ms}(l,v) = \frac{(1 - E(l)) (1 - E(v)) F_{avg}^2 E_{avg}}{\pi (1 - E_{avg}) (1 - F_{avg}(1 - E_{avg}))}$</p>
<p>å…¶ä¸­Eæ˜¯specluar BRDFçš„æ–¹å‘albedo $f_r$(å‚æ•°$f_0$)è®¾å®šä¸º1ï¼š</p>
<p>$E(l) = \int_{\Omega} f(l,v) (n\cdot v) dv$</p>
<p>å…¶ä¸­$E_{avg}$è¡¨ç¤ºEçš„cosåŠ æƒå¹³å‡ï¼š</p>
<p>$E_{avg} = 2 \int_0^1 E(\mu) \mu d\mu$</p>
<p>åŒæ ·çš„ï¼Œ$F_{avg}$è¡¨ç¤ºFresnelé¡¹çš„cosåŠ æƒå¹³å‡ï¼š</p>
<p>$F_{avg} = 2 \int_0^1 F(\mu) \mu d\mu$</p>
<p>$E$å’Œ$E_{avg}$éƒ½å¯ä»¥é€šè¿‡é¢„è®¡ç®—è¡¨ç¤ºåœ¨lookup tableä¸­ï¼Œ$F_{avg}$é€šè¿‡Schlickè¿‘ä¼¼å¯ä»¥è¢«æå¤§ç®€åŒ–ä¸ºï¼š</p>
<p>$F_{avg} = \frac{1 + 20 f_0}{21}$</p>
<p>æ–°çš„å…¬å¼åŒ…å«å•æ¬¡æ•£å°„ï¼ˆsingle scatteringï¼‰å’Œå¤šæ¬¡æ•£å°„ï¼ˆmulti scatteringï¼‰è¡¨ç¤ºä¸º$f_r$ï¼š</p>
<p>$f_{r}(l,v) = f_{ss}(l,v) + f_{ms}(l,v)$</p>
<p>åœ¨[Lagarde18]ä¸­ï¼Œé€šè¿‡è§‚å¯Ÿ$f_{avg}$å¯ä»¥è¿‘ä¼¼ä¸º$f_0$ï¼Œå¹¶ä¸”é€šè¿‡é€šè¿‡æ·»åŠ ä¸€ä¸ªå¸¦ç³»æ•°çš„GGX specularé¡¹æ¥å®Œæˆèƒ½é‡è¡¥å¿ï¼š</p>
<p>$f_{ms}(l,v) = f_0 \frac{1 - E(l)}{E(l)} f_{ss}(l,v)$</p>
<p>æœ€å…³é”®çš„ä¸€ç‚¹æ˜¯$E(l)$ä¸ä»…èƒ½å¤Ÿé¢„è®¡ç®—ï¼Œè€Œä¸”ä¸IBLé¢„ç§¯åˆ†å…±åŒä½¿ç”¨ï¼Œèƒ½é‡è¡¥å¿å…¬å¼å˜ä¸ºï¼š</p>
<p>$f_r(l,v) = f_{ss}(l,v) + f_0 \left( \frac{1}{r} - 1 \right) f_{ss}(l,v)$</p>
<p>å…¶ä¸­$r$ï¼š</p>
<p>$r = \int_{\Omega} D(l,v) V(l,v) \left&lt; n \cdot l \right&gt; dl$</p>
<p>å¦‚æœæŠŠ$r$ä¿å­˜åœ¨DFG lookup tableä¸­ï¼Œå¯ä»¥ä»¥è¿‘ä¼¼å¿½ç•¥ä¸è®¡çš„è®¡ç®—é‡å®Œæˆèƒ½é‡è¡¥å¿å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vec3 energyCompensation = 1.0 + f0 * (1.0 / dfg.y - 1.0);</span><br><span class="line">// Scale the specular lobe to account for multiscattering</span><br><span class="line">Fr *= pixel.energyCompensation;</span><br></pre></td></tr></table></figure>
<p>åç»­ç« èŠ‚ä»‹ç»DFG lookup tableçš„è®¡ç®—ä¸é©±åŠ¨ã€‚</p>

    </div>

    
    
    

      <footer class="post-footer">

        

      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="å¼ å²©"
    src="/uploads/avatar.jpg">
  <p class="site-author-name" itemprop="name">å¼ å²©</p>
  <div class="site-description" itemprop="description">å¼ å²©çš„ä¸ªäººblog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">1</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¼ å²©</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">ä¸»é¢˜ â€“ <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.5.0
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

  

</body>
</html>
